<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="fi">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>mainGUI &mdash; Älykäs reseptikirja 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="top" title="Älykäs reseptikirja 1.0 documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for mainGUI</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Created on 27.4.2016</span>

<span class="sd">@author: Kimi Päivärinta</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1">#!/usr/bin/python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">GUIDesign</span> <span class="kn">import</span> <span class="n">Ui_MainWindow</span>
<span class="kn">from</span> <span class="nn">GUIRecipeDialog</span> <span class="kn">import</span> <span class="n">Ui_Dialog</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span><span class="p">,</span><span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QDialog</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="kn">import</span> <span class="n">QDoubleValidator</span><span class="p">,</span> <span class="n">QRegExpValidator</span><span class="p">,</span> <span class="n">QIntValidator</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">QRegExp</span><span class="p">,</span> <span class="n">Qt</span>


<span class="kn">from</span> <span class="nn">IO</span> <span class="kn">import</span> <span class="n">IO</span>
<span class="kn">from</span> <span class="nn">recipe</span> <span class="kn">import</span> <span class="n">Recipe</span>
<span class="kn">from</span> <span class="nn">ingredient</span> <span class="kn">import</span> <span class="n">IngredientContainer</span><span class="p">,</span> <span class="n">Ingredient</span>
<span class="kn">from</span> <span class="nn">customErrors</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">search</span> <span class="kn">import</span> <span class="n">Search</span>
<span class="kn">import</span> <span class="nn">codecs</span>

<span class="n">STORAGE</span> <span class="o">=</span> <span class="s1">&#39;varasto.csv&#39;</span>
<span class="n">RECIPES</span> <span class="o">=</span> <span class="s1">&#39;reseptit.txt&#39;</span>
<span class="n">INGREDIENTS</span> <span class="o">=</span> <span class="s1">&#39;raaka_aineet.txt&#39;</span>

<div class="viewcode-block" id="MainGUI"><a class="viewcode-back" href="../Ohjelman_rakenne.html#mainGUI.MainGUI">[docs]</a><span class="k">class</span> <span class="nc">MainGUI</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">,</span> <span class="n">Ui_MainWindow</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Tämä luokka perii pyqt:n QMainWindow luokan sekä QT Designerilla luodun Ui_MainWindow luokan, joka on moduulissa GUIDesign.</span>
<span class="sd">    Ui_MainWindow luokka sisältää graafisen käyttöliittymän designin.</span>
<span class="sd">    </span>
<span class="sd">    Luokka sisältää paljon metodeja, joilla tehdään muutoksia, kun käyttöliittymällä tapahtuu muutoksia. Metodit voidaan jakaa karkeasti osiin</span>
<span class="sd">    </span>
<span class="sd">    Metodit:</span>
<span class="sd">        :init*: Luokan luomisen yhteydessä asetetaan nappuloiden toiminnallisuudet, ladataan tiedostoja ym.</span>
<span class="sd">        :populate*: Piirretään data johonkin tauluun</span>
<span class="sd">        :save*: Tallennetaan muuttunutta dataa</span>
<span class="sd">        :add*: Lisätään uusi ohje/raaka-aine/ym.</span>
<span class="sd">        :get*InDataListForTable: Metodit palauttavat niille annetun listan olennaisimmat tiedot &quot;data&quot; tyyppinä, joka voidaan antaa populateTableWith() metodille populoitavaksi</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Kutsuu Ui_MainWindow luokan konstruktoria, käyttöliittymän rakentamiseksi. Tämän lisäksi kutsutaan muita init metodeja, </span>
<span class="sd">        joilla mm. määritellään painikkeiden toiminnalisuudet ja ladataan tarvittavat tiedot tiedostoista</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initSettingsAndLists</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initTablesAndLists</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initToEditVariables</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initLineEdits</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initButtons</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populateAllMainTables</span><span class="p">()</span>
    
<div class="viewcode-block" id="MainGUI.initSettingsAndLists"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.initSettingsAndLists">[docs]</a>    <span class="k">def</span> <span class="nf">initSettingsAndLists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi alustaa tarvittavat muuttujat ja oliot sekä lataa reseptit, raaka-aineet ja varastotilanteen tiedostoista listoihin.&#39;&#39;&#39;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">storageFile</span><span class="o">=</span> <span class="n">STORAGE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipesFile</span><span class="o">=</span> <span class="n">RECIPES</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsFile</span><span class="o">=</span> <span class="n">INGREDIENTS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IO</span> <span class="o">=</span> <span class="n">IO</span><span class="p">()</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storageList</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">search</span> <span class="o">=</span> <span class="n">Search</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">loadFromFileToList</span><span class="p">()</span> <span class="c1"># Sender on None, joten luetaan kaikki</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">loadRecipesForIngredients</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="MainGUI.initButtons"><a class="viewcode-back" href="../Ohjelman_rakenne.html#mainGUI.MainGUI.initButtons">[docs]</a>    <span class="k">def</span> <span class="nf">initButtons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tässä metodissa määritellään käyttöliittymän painikkeiden toiminallisuudet&#39;&#39;&#39;</span>
        
        <span class="c1">#Varastonäkymä</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonSaveStorageInfo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveStorageEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonPopulateStorage</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populateStorageTable</span><span class="p">)</span>

        <span class="c1">#Raak-ainenäkymä</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonPopulateIngredients</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populateIngredientsTable</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonSaveIngredientInfo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveIngredientsEdit</span><span class="p">)</span>
        
        <span class="c1">#Reseptinäkymä</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonPopulateRecipes</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesTable</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonSaveRecipesInfo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveRecipesEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonSaveRecipeIngredient</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveRecipesIngredientEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonSaveRecipeInstruction</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveRecipesInstructionsEdit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonCreateNewRecipe</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showCreateNewRecipeDialog</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonNewRecipeIngredient</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addNewRecipeIngredient</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonNewRecipeInstruction</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addNewRecipeInstruction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonDeleteRecipeIngredient</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deleteRecipeIngredient</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonDeleteRecipeInstruction</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deleteRecipeInstruction</span><span class="p">)</span>
        
        <span class="c1">#Haku näkymä</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonSearch</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populateSearchTable</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkMissingN</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkStateChanged</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkFoundN</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkStateChanged</span><span class="p">)</span>
        
        <span class="c1">#Asetukset näkymä</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonLoadAll</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loadFromFileToList</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonLoadIngredients</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loadFromFileToList</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonLoadRecipes</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loadFromFileToList</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonLoadStorage</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loadFromFileToList</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonSaveAll</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveToFile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonSaveIngredients</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveToFile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonSaveRecipes</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveToFile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonSaveStorage</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveToFile</span><span class="p">)</span></div>
        
           
<div class="viewcode-block" id="MainGUI.initTablesAndLists"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.initTablesAndLists">[docs]</a>    <span class="k">def</span> <span class="nf">initTablesAndLists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tässä metodissa määritellään käyttöliittymän taulukkojen toiminnallisuudet, esim. kun taulukon riviä klikataan&#39;&#39;&#39;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">storageTable</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populateStorageEditFields</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsTable</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populateIngredientsEditFields</span><span class="p">)</span>
        
        <span class="c1">#Reseptinäkymä</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipesTable</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesEditFields</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientsTable</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesIngredientEditFields</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeInstructionsTable</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesInstructionsEditFields</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="MainGUI.initLineEdits"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.initLineEdits">[docs]</a>    <span class="k">def</span> <span class="nf">initLineEdits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tässä metodissa alustetaan tarvittavat validaattorit sekä asetetaan nämä validaattorit käyttöön käyttöliittymän</span>
<span class="sd">        tekstikentille. </span>
<span class="sd">        </span>
<span class="sd">        Käytettävät validaattorit ovat</span>
<span class="sd">        :min2char: vähintään 2 merkkiä pitkä</span>
<span class="sd">        :min1tomax10char: 1-10 merkkiä aakkosia</span>
<span class="sd">        :float2decimals: desimaaliluku, jossa 2 desimaalia</span>
<span class="sd">        :onlyint: ainoastaan kokonaislukuja</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Validaattoreiden alustaminen</span>
        <span class="n">min2char</span> <span class="o">=</span> <span class="n">QRegExpValidator</span><span class="p">(</span><span class="n">QRegExp</span><span class="p">(</span><span class="s2">&quot;^[\w\s]{2,}$&quot;</span><span class="p">))</span>
        <span class="n">min1tomax10char</span> <span class="o">=</span> <span class="n">QRegExpValidator</span><span class="p">(</span><span class="n">QRegExp</span><span class="p">(</span><span class="s2">&quot;^[a-zA-Z]{1,10}$&quot;</span><span class="p">))</span>
        <span class="n">float2decimals</span> <span class="o">=</span> <span class="n">QDoubleValidator</span><span class="p">(</span><span class="mf">0.00</span><span class="p">,</span><span class="mf">999999999.00</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">onlyint</span> <span class="o">=</span> <span class="n">QIntValidator</span><span class="p">()</span>
        
        <span class="c1">#Varastosivujen tekstikenttien validaattorit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storageQuantity</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">float2decimals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storageName</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">min2char</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storageUnit</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">min1tomax10char</span><span class="p">)</span>
        
        <span class="c1">#Raaka-ainesivun validaattorit. Allergeenit ja resepti ei pakollisia.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ingredientName</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">min2char</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ingredientDensity</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">float2decimals</span><span class="p">)</span>
        
        <span class="c1">#Reseptisivun validaattorit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeName</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">min2char</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeTime</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">onlyint</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeOutcomeSize</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">float2decimals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeOutcomeUnit</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">min1tomax10char</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientQuantity</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">float2decimals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientUnit</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">min1tomax10char</span><span class="p">)</span></div>
        
        
<div class="viewcode-block" id="MainGUI.initToEditVariables"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.initToEditVariables">[docs]</a>    <span class="k">def</span> <span class="nf">initToEditVariables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tässä metodissa alustetaan apumuuttujat, joilla pidetään kirjaa mikä rivi mistäkin taulukosta on valittuna. </span>
<span class="sd">        Tätä tietoa tarvitaan taulukon tietojen muuttamisessa, esim. reseptin nimen.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ingredientToEdit</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientToEdit</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeInstructionToEdit</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storageToEdit</span> <span class="o">=</span> <span class="bp">None</span></div>
    
<div class="viewcode-block" id="MainGUI.initDialogLineEdits"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.initDialogLineEdits">[docs]</a>    <span class="k">def</span> <span class="nf">initDialogLineEdits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tässä metodissa alustetaan tarvittavat validaattorit sekä asetetaan nämä validaattorit käyttöön käyttöliittymän </span>
<span class="sd">        &quot;Uusi resepti&quot; dialogin tekstikenttiin</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">min2char</span> <span class="o">=</span> <span class="n">QRegExpValidator</span><span class="p">(</span><span class="n">QRegExp</span><span class="p">(</span><span class="s2">&quot;^[\w\s]{2,}$&quot;</span><span class="p">))</span>
        <span class="n">min1tomax10char</span> <span class="o">=</span> <span class="n">QRegExpValidator</span><span class="p">(</span><span class="n">QRegExp</span><span class="p">(</span><span class="s2">&quot;^[a-zA-Z]{1,10}$&quot;</span><span class="p">))</span>
        <span class="n">float2decimals</span> <span class="o">=</span> <span class="n">QDoubleValidator</span><span class="p">(</span><span class="mf">0.00</span><span class="p">,</span><span class="mf">999999999.00</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">onlyint</span> <span class="o">=</span> <span class="n">QIntValidator</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogName</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">min2char</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogTime</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">onlyint</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogOutcomeSize</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">float2decimals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogOutcomeUnit</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">min1tomax10char</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogIngredient</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">min2char</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">DialogQuantity</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">float2decimals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogUnit</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">min1tomax10char</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogInstruction</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">min2char</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainGUI.populateAllMainTables"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.populateAllMainTables">[docs]</a>    <span class="k">def</span> <span class="nf">populateAllMainTables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi kutsuu kaikkien päätaulukoiden (reseptit, varastotilanne, raaka-aineet) populointimetodeja&#39;&#39;&#39;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">populateStorageTable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populateIngredientsTable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesTable</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="MainGUI.populateTableWithData"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.populateTableWithData">[docs]</a>    <span class="k">def</span> <span class="nf">populateTableWithData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi populoi annettuun QTableWidget tauluun annetun datan. Datan tulee olla muotoa esim.</span>
<span class="sd">        data = [ [&#39;Nimi&#39;,&#39;Määrä&#39;], [&#39;Kala&#39;, &#39;Peruna&#39;], [5,3] ]</span>
<span class="sd">        </span>
<span class="sd">        Taulun sisältö tyhjennetään aluksi, asetetaan asetetaan sarakkeiden ja rivien lukumäärät. Tämän jälkeen</span>
<span class="sd">        taulu populoidaan datalla, jonka jällkeen kolumnien leveydet skaalataan sisällölle sopivaksi.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">table</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">table</span><span class="o">.</span><span class="n">setHorizontalHeaderLabels</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        
        <span class="n">data</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="nb">next</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># Skipataan eka, koska ne on headerit</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">columnData</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">columnData</span><span class="p">):</span>
                <span class="n">newitem</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">newitem</span><span class="p">)</span>
            
        <span class="n">table</span><span class="o">.</span><span class="n">resizeColumnsToContents</span><span class="p">()</span>
        <span class="n">table</span><span class="o">.</span><span class="n">resizeRowsToContents</span><span class="p">()</span>
        <span class="n">table</span><span class="o">.</span><span class="n">clear</span>
        <span class="n">table</span><span class="o">.</span><span class="n">horizontalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setStretchLastSection</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="MainGUI.populateSearchTable"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.populateSearchTable">[docs]</a>    <span class="k">def</span> <span class="nf">populateSearchTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi populoi datan hakunäkymän taulukkoon. Tätä metodia kutsuu hakunäkymän &quot;Hae&quot; painike.</span>
<span class="sd">        </span>
<span class="sd">        Hakunäkymällä on mahdollista valita nolla tai useampi hakuvaihtoehto, tämä metodi sisältää myös logiikan </span>
<span class="sd">        valittujen vaihtoehtojen tarkastamiselle sekä oikean hakutuloksen saamiseksi.</span>
<span class="sd">        </span>
<span class="sd">        Haku hyödyntää Search luokan metodeja, jotka palauttavat listan resepteistä, jotka täyttävät hakukriteerin. </span>
<span class="sd">        Hakulogiikka on ns. iteratiivinen ja alussa Search luokan metodeille annetaan listana kaikki tunnetut reseptit,</span>
<span class="sd">        mahdollinen seuraava haku kuitenkin tehdään edellisen haun palauttamasta listasta, jolloin lopuksi listassa on enää kaikki</span>
<span class="sd">        hakutulokset täyttävät reseptit.</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">searchList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkName</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">searchList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">searchFromList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">searchName</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> <span class="n">searchList</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkAllergen</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">searchList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">searchNoAllergen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">searchAllergen</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> <span class="n">searchList</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkIngredient</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">searchList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">searchIncludesIngredient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">searchIngredient</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> <span class="n">searchList</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkFoundN</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">searchList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">searcForhRecipesNIngredientsInStorage</span><span class="p">(</span><span class="n">searchList</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinFoundN</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageList</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkMissingN</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spinMissingN</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>
            <span class="n">searchList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">searcForhRecipesNIngredientsInStorage</span><span class="p">(</span><span class="n">searchList</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spinMissingN</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageList</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">searchList</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRecipesInDataListForTable</span><span class="p">(</span><span class="n">searchList</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populateTableWithData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">searchTable</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Reseptejä ei löytynyt hakuehdoilla&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">searchTable</span><span class="o">.</span><span class="n">clearContents</span><span class="p">()</span></div>
                
<div class="viewcode-block" id="MainGUI.populateStorageTable"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.populateStorageTable">[docs]</a>    <span class="k">def</span> <span class="nf">populateStorageTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi populoi varastolistaus tauluun kaikki varastossa olevat raaka-aineet&#39;&#39;&#39;</span>
        
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getIngredientContainersInDataListForTable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storageList</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populateTableWithData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storageTable</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Varastolistaus päivitetty&quot;</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="MainGUI.populateStorageEditFields"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.populateStorageEditFields">[docs]</a>    <span class="k">def</span> <span class="nf">populateStorageEditFields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mi</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi populoi varastonäkymällä olevat tekstikentät, joilla voi muokata varastossa olevaa raaka-ainetta.</span>
<span class="sd">        Tätä metodia kutsutaan, kun varastolistauksessa klikataan riviä.</span>
<span class="sd">        </span>
<span class="sd">        Rivin indeksi tallennetaan self.storageToEdit muuttujaan, jotta muutoksia tallennettaessa tiedetään</span>
<span class="sd">        mitä varasto raaka-ainetta täytyy muokata</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            :mi: mi muuttuja/olio, joka sisältää klikatun rivin ja kolumnin indeksin.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">if</span> <span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storageList</span><span class="p">):</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Riviä ei voitu valita&quot;</span><span class="p">,</span> <span class="s2">&quot;Päivitä listaus!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storageToEdit</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ingredient</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageList</span><span class="p">[</span><span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storageName</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storageQuantity</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">getQuantityStr</span><span class="p">()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storageUnit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">getUnit</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storageToEdit</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainGUI.populateIngredientsTable"><a class="viewcode-back" href="../Ohjelman_rakenne.html#mainGUI.MainGUI.populateIngredientsTable">[docs]</a>    <span class="k">def</span> <span class="nf">populateIngredientsTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi populoi raaka-ainelistaus tauluun kaikki tiedetyt raaka-aineet &#39;&#39;&#39;</span>
        
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getIngredientsInDataListForTable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populateTableWithData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientsTable</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Raaka-ainelistaus päivitetty&quot;</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="MainGUI.populateIngredientsEditFields"><a class="viewcode-back" href="../Ohjelman_rakenne.html#mainGUI.MainGUI.populateIngredientsEditFields">[docs]</a>    <span class="k">def</span> <span class="nf">populateIngredientsEditFields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mi</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi populoi raaka-ainenäkymällä olevat tekstikentät, joilla voi muokata raaka-aineen tietoja.</span>
<span class="sd">        Tätä metodia kutsutaan, kun raaka-ainelistaus taulua klikataan.</span>
<span class="sd">        </span>
<span class="sd">        Rivin indeksi tallennetaan self.ingredientToEdit muuttujaan, jotta muutoksia tallennettaessa tiedetään</span>
<span class="sd">        mitä raaka-ainetta täytyy muokata.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            :mi: mi muuttuja/olio, joka sisältää klikatun rivin ja kolumnin indeksin.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">if</span> <span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">):</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Riviä ei voitu valita&quot;</span><span class="p">,</span> <span class="s2">&quot;Päivitä listaus!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ingredientToEdit</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ingredient</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">[</span><span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ingredientName</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ingredientDensity</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">getDensityGUI</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ingredientAllergens</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">getAllergensGUI</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ingredientRecipe</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">getRecipeGUI</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ingredientToEdit</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()</span></div>
           
<div class="viewcode-block" id="MainGUI.populateRecipesTable"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.populateRecipesTable">[docs]</a>    <span class="k">def</span> <span class="nf">populateRecipesTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi populoi reseptilistaus tauluun kaikki tiedetyt reseptit &#39;&#39;&#39;</span>
        
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRecipesInDataListForTable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populateTableWithData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipesTable</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Reseptilistaus päivitetty&quot;</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="MainGUI.populateRecipesInstructionsTable"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.populateRecipesInstructionsTable">[docs]</a>    <span class="k">def</span> <span class="nf">populateRecipesInstructionsTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi populoi reseptinäkymällä reseptin ohjeet tauluun. </span>
<span class="sd">        Tätä metodia kutsutaan, kun reseptilistaus taulua klikataan.</span>
<span class="sd">        </span>
<span class="sd">        Oikean reseptin löytämiseksi hyödynnetään self.recipeToEdit muuttujaa.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearRecipeEditLineEdits</span><span class="p">()</span>
        <span class="n">recipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;Ohje&#39;</span><span class="p">],</span> <span class="n">recipe</span><span class="o">.</span><span class="n">getInstructions</span><span class="p">()]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populateTableWithData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeInstructionsTable</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="MainGUI.populateRecipesIngredientsTable"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.populateRecipesIngredientsTable">[docs]</a>    <span class="k">def</span> <span class="nf">populateRecipesIngredientsTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi populoi reseptinäkymällä reseptin raaka-aineet tauluun. </span>
<span class="sd">        Tätä metodia kutsutaan, kun reseptilistaus taulua klikataan.</span>
<span class="sd">        </span>
<span class="sd">        Oikean reseptin löytämiseksi hyödynnetään self.recipeToEdit muuttujaa.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearRecipeEditLineEdits</span><span class="p">()</span>
        <span class="n">recipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getIngredientContainersInDataListForTable</span><span class="p">(</span><span class="n">recipe</span><span class="o">.</span><span class="n">getIngredients</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populateTableWithData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientsTable</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="MainGUI.populateRecipesEditFields"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.populateRecipesEditFields">[docs]</a>    <span class="k">def</span> <span class="nf">populateRecipesEditFields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mi</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi populoi reseptinäkymällä olevat reseptin tekstikentät sekä tyhjentää reseptin raaka-aine ja</span>
<span class="sd">        ohje muokkaustekstikentät sekä kutuu metodeja, joilla populoidaan reseptin raaka-aine ja ohjetaulut.</span>
<span class="sd">        </span>
<span class="sd">        Tätä metodia kutsutaan, kun reseptilistaus taulua klikataan.</span>
<span class="sd">        </span>
<span class="sd">        Rivin indeksi tallennetaan self.recipeToEdit muuttujaan, jotta muutoksia tallennettaessa tiedetään</span>
<span class="sd">        mitä reseptiä täytyy muokata. </span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            :mi: mi muuttuja/olio, joka sisältää klikatun rivin ja kolumnin indeksin.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">if</span> <span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">):</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Riviä ei voitu valita&quot;</span><span class="p">,</span> <span class="s2">&quot;Päivitä listaus!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">recipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">[</span><span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()</span>

            <span class="c1">#Yleisien tietojen populoiminen</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipeName</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">recipe</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipeTime</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">recipe</span><span class="o">.</span><span class="n">getTimeGUI</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipeOutcomeSize</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">recipe</span><span class="o">.</span><span class="n">getOutcomeSizeGUI</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipeOutcomeUnit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">recipe</span><span class="o">.</span><span class="n">getOutcomeUnit</span><span class="p">())</span>
            
            <span class="c1">#Muokkauskenttien nollaus</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clearRecipeEditLineEdits</span><span class="p">()</span>
            
            <span class="c1">#Aputaulujen populointi</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesIngredientsTable</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesInstructionsTable</span><span class="p">()</span></div>
            
<div class="viewcode-block" id="MainGUI.populateRecipesIngredientEditFields"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.populateRecipesIngredientEditFields">[docs]</a>    <span class="k">def</span> <span class="nf">populateRecipesIngredientEditFields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mi</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi populoi reseptinäkymällä olevat raaka-aine tekstikentät, joilla voi muokata reseptin raaka-aineen tietoja.</span>
<span class="sd">        Tätä metodia kutsutaan, kun reseptin raaka-ainelistaus taulua klikataan.</span>
<span class="sd">        </span>
<span class="sd">        Rivin indeksi tallennetaan self.recipeIngredientToEdit muuttujaan, jotta muutoksia tallennettaessa tiedetään</span>
<span class="sd">        mitä raaka-ainetta täytyy muokata.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            :mi: mi muuttuja/olio, joka sisältää klikatun rivin ja kolumnin indeksin.</span>
<span class="sd">        &#39;&#39;&#39;</span> 
        
        <span class="n">ingredients</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span><span class="p">]</span><span class="o">.</span><span class="n">getIngredients</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ingredients</span><span class="p">):</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Riviä ei voitu valita&quot;</span><span class="p">,</span> <span class="s2">&quot;Päivitä listaus!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientToEdit</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ingredient</span> <span class="o">=</span> <span class="n">ingredients</span><span class="p">[</span><span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientName</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientQuantity</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">getQuantityStr</span><span class="p">()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientUnit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">getUnit</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientToEdit</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()</span>        </div>
       
<div class="viewcode-block" id="MainGUI.populateRecipesInstructionsEditFields"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.populateRecipesInstructionsEditFields">[docs]</a>    <span class="k">def</span> <span class="nf">populateRecipesInstructionsEditFields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mi</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi populoi reseptinäkymällä olen ohje tekstikentät, joilla voi muokata reseptin ohjetta.</span>
<span class="sd">        Tätä metodia kutsutaan, kun reseptin ohjelistaus taulua klikataan.</span>
<span class="sd">        </span>
<span class="sd">        Rivin indeksi tallennetaan self.recipeInstructionToEdit muuttujaan, jotta muutoksia tallennettaessa tiedetään</span>
<span class="sd">        mitä raaka-ainetta täytyy muokata.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            :mi: mi muuttuja/olio, joka sisältää klikatun rivin ja kolumnin indeksin.</span>
<span class="sd">        &#39;&#39;&#39;</span> 
        <span class="n">instructions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span><span class="p">]</span><span class="o">.</span><span class="n">getInstructions</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">instructions</span><span class="p">):</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Riviä ei voitu valita&quot;</span><span class="p">,</span> <span class="s2">&quot;Päivitä listaus!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipeInstructionToEdit</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">instruction</span> <span class="o">=</span> <span class="n">instructions</span><span class="p">[</span><span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipeInstruction</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span><span class="n">instruction</span><span class="p">)</span>        
            <span class="bp">self</span><span class="o">.</span><span class="n">recipeInstructionToEdit</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">row</span><span class="p">()</span>   </div>
                 
<div class="viewcode-block" id="MainGUI.clearRecipeEditLineEdits"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.clearRecipeEditLineEdits">[docs]</a>    <span class="k">def</span> <span class="nf">clearRecipeEditLineEdits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi tyhjentää reseptin raaka-aine sekä ohjeen tekstikentät.</span>
<span class="sd">        Tätä metodia kutsutaan, kun reseptilistaus taulua klikataan, jotta kyseisissä tekstikentissä ei &quot;vanhoja&quot; tietoja.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientToEdit</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeInstructionToEdit</span> <span class="o">=</span> <span class="bp">None</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeInstruction</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientName</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientQuantity</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientUnit</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>    </div>
        
<div class="viewcode-block" id="MainGUI.showCreateNewRecipeDialog"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.showCreateNewRecipeDialog">[docs]</a>    <span class="k">def</span> <span class="nf">showCreateNewRecipeDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi luo uuden QDialog widgetin, jossa voi täyttää uuden reseptin tietoja. Dialogin</span>
<span class="sd">        graafinen ulkoasu on luotu QT Designerilla ja on tallennettuna moduuliin GUIrecipeDialog.</span>
<span class="sd">        </span>
<span class="sd">        Jos dialogissa painetaan &quot;OK&quot; painiketta, kutsutaan metodia self.saveNewRecipe(), joka annetut tiedot</span>
<span class="sd">        ja tallentaa reseptin.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialog</span> <span class="o">=</span> <span class="n">QDialog</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span> <span class="o">=</span> <span class="n">Ui_Dialog</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dialog</span><span class="p">)</span>   
        <span class="bp">self</span><span class="o">.</span><span class="n">initDialogLineEdits</span><span class="p">()</span>     
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">saveNewRecipe</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Tallennus keskeytetty&quot;</span><span class="p">)</span>     </div>
        
<div class="viewcode-block" id="MainGUI.addNewRecipeInstruction"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.addNewRecipeInstruction">[docs]</a>    <span class="k">def</span> <span class="nf">addNewRecipeInstruction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi tallentaa reseptinäkymällä ohjetekstikentässä olevan tekstin uudeksi ohjeeksi reseptille. </span>
<span class="sd">        Oikean reseptin löytymiseksi hyödynnetään self.recipeToEdit muuttujaa.</span>
<span class="sd">        </span>
<span class="sd">        Tallennuksen jälkeen metodi populoi uudelleen reseptin ohjelistaus taulun.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">recipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span><span class="p">]</span>
            <span class="n">recipe</span><span class="o">.</span><span class="n">addInstruction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeInstruction</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clearRecipeEditLineEdits</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesInstructionsTable</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Ohje lisätty&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SetAttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span></div>


    
<div class="viewcode-block" id="MainGUI.addNewRecipeIngredient"><a class="viewcode-back" href="../Ohjelman_rakenne.html#mainGUI.MainGUI.addNewRecipeIngredient">[docs]</a>    <span class="k">def</span> <span class="nf">addNewRecipeIngredient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi tarkastaa ja tallentaa reseptinäkymällä raaka-aine tekstikentissä olevat tekstit </span>
<span class="sd">        uudeksi raaka-aineeksi reseptille. </span>
<span class="sd">        Oikean reseptin löytymiseksi hyödynnetään self.recipeToEdit muuttujaa.</span>
<span class="sd">        </span>
<span class="sd">        Tallennuksen jälkeen metodi populoi uudelleen reseptin raaka-ainelistaus taulun.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientName</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientQuantity</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientUnit</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">recipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span><span class="p">]</span>
                <span class="n">ingredient</span> <span class="o">=</span> <span class="n">IngredientContainer</span><span class="p">()</span>
                <span class="n">ingredient</span><span class="o">.</span><span class="n">setIngredient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientName</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">)</span>
                <span class="n">ingredient</span><span class="o">.</span><span class="n">setQuantity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientQuantity</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">ingredient</span><span class="o">.</span><span class="n">setUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientUnit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">addIngredientContainer</span><span class="p">(</span><span class="n">ingredient</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesIngredientsTable</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Raaka-aine lisätty&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">SetAttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="s2">&quot;Virheellinen syöte!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainGUI.deleteRecipeIngredient"><a class="viewcode-back" href="../Ohjelman_rakenne.html#mainGUI.MainGUI.deleteRecipeIngredient">[docs]</a>    <span class="k">def</span> <span class="nf">deleteRecipeIngredient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi poistaa valitun reseptin valitun raaka-aineen.</span>
<span class="sd">        </span>
<span class="sd">        Metodia kutsutaan painamalla poista painiketta. Oikea resepti ja raaka-aine selviää </span>
<span class="sd">        muuttujista self.recipeToEdit ja self.recipeIngredientToEdit</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientToEdit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">recipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span><span class="p">]</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">deleteIngredient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientToEdit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesIngredientsTable</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Raaka-aine poistettu&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">SetAttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="s2">&quot;Päivitä listaus ja valitse resepti sekä raaka-aine uudelleen!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="MainGUI.deleteRecipeInstruction"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.deleteRecipeInstruction">[docs]</a>    <span class="k">def</span> <span class="nf">deleteRecipeInstruction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi poistaa valitun reseptin valitun ohjeen.</span>
<span class="sd">        </span>
<span class="sd">        Metodia kutsutaan painamalla poista painiketta. Oikea resepti ja ohje selviää </span>
<span class="sd">        muuttujista self.recipeToEdit ja self.recipeInstructionToEdit</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeInstructionToEdit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">recipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span><span class="p">]</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">deleteInstruction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeInstructionToEdit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesInstructionsTable</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Ohje poistettu&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">SetAttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="s2">&quot;Päivitä listaus ja valitse resepti sekä ohje uudelleen!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span></div>


<div class="viewcode-block" id="MainGUI.checkStateChanged"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.checkStateChanged">[docs]</a>    <span class="k">def</span> <span class="nf">checkStateChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi pitää huolen, ettei hakunäkymällä olevat &quot;Puuttuu N&quot; ja &quot;Löytyy N&quot; checkboksit ole valittuna samaan aikaan,</span>
<span class="sd">        koska se ei ole järin järkevä hakuvaihtoehto. </span>
<span class="sd">        </span>
<span class="sd">        Tätä metodia kutsutaan vaihtamalla jomman kumman checkboksin tilaa.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Jos rasti otettiin pois, niin toisen tilaa ei tarvitse vaihtaa</span>
        <span class="k">if</span> <span class="n">state</span> <span class="o">!=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkFoundN</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkMissingN</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkMissingN</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkFoundN</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></div>
            

<div class="viewcode-block" id="MainGUI.saveNewRecipe"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.saveNewRecipe">[docs]</a>    <span class="k">def</span> <span class="nf">saveNewRecipe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi tarkastaa uusi resepti -dialogissa annetut tiedot ja valideja, niin luo uuden reseptin näillä tiedoilla</span>
<span class="sd">        ja lisää sen reseptilistaan. Tämän jälkeen reseptilistaus taulu populoidaan uudelleen.</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogName</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogInstruction</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogIngredient</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogOutcomeSize</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogOutcomeUnit</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">DialogQuantity</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogTime</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogUnit</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">():</span>
            <span class="n">recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">today</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogName</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">setDate</span><span class="p">(</span><span class="n">today</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">.%m.%Y&quot;</span><span class="p">))</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">setTime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogTime</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">addInstruction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogInstruction</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">setOutcomeSize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogOutcomeSize</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">setOutcomeUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogOutcomeUnit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                
                <span class="n">ingredient</span> <span class="o">=</span> <span class="n">IngredientContainer</span><span class="p">()</span>
                <span class="n">ingredient</span><span class="o">.</span><span class="n">setIngredient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogIngredient</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">)</span>
                <span class="n">ingredient</span><span class="o">.</span><span class="n">setQuantity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">DialogQuantity</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">ingredient</span><span class="o">.</span><span class="n">setUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeDialog</span><span class="o">.</span><span class="n">dialogUnit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">addIngredient</span><span class="p">(</span><span class="n">ingredient</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">recaddIngredientContainernd</span><span class="p">(</span><span class="n">recipe</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesTable</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Reseptin tallennus onnistui&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">SetAttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="s2">&quot;Kaikissa kentissä ei syötettä&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span></div>

                 
<div class="viewcode-block" id="MainGUI.saveRecipesEdit"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.saveRecipesEdit">[docs]</a>    <span class="k">def</span> <span class="nf">saveRecipesEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi tarkistaa reseptin perustietojen tekstikenttien arvot, jonka jälkeen muutokset tallennetaan reseptiin.</span>
<span class="sd">        </span>
<span class="sd">        Oikea resepti löydetään self.recipeToEdit muuttujan avulla.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeName</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeTime</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeOutcomeSize</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeOutcomeUnit</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">recipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span><span class="p">]</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeName</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">setTime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeTime</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">setOutcomeSize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeOutcomeSize</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">recipe</span><span class="o">.</span><span class="n">setOutcomeUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeOutcomeUnit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Reseptin perustiedot tallennettu&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesTable</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">SetAttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="s2">&quot;Virheellinen syöte!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="MainGUI.saveRecipesIngredientEdit"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.saveRecipesIngredientEdit">[docs]</a>    <span class="k">def</span> <span class="nf">saveRecipesIngredientEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi tarkistaa reseptin raaka-aineen tekstikenttien arvot, jonka jälkeen muutokset tallennetaan reseptiin.</span>
<span class="sd">        </span>
<span class="sd">        Oikea resepti sekä raaka-aine löydetään self.recipeToEdit ja self.recipeIngredientToEdit muuttujien avulla.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientQuantity</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientUnit</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientToEdit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ingredient</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span><span class="p">]</span><span class="o">.</span><span class="n">getIngredients</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientToEdit</span><span class="p">]</span>
                <span class="n">ingredient</span><span class="o">.</span><span class="n">setQuantity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientQuantity</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">ingredient</span><span class="o">.</span><span class="n">setUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeIngredientUnit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Reseptin raaka-aine tallennettu&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesIngredientsTable</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">SetAttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="s2">&quot;Virheellinen syöte!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="MainGUI.saveRecipesInstructionsEdit"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.saveRecipesInstructionsEdit">[docs]</a>    <span class="k">def</span> <span class="nf">saveRecipesInstructionsEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi tallentaa annetun ohjetekstin reseptille.</span>
<span class="sd">        </span>
<span class="sd">        Oikea resepti sekä ohje löydetään self.recipeToEdit ja self.recipeInstructionToEdit muuttujien avulla.</span>
<span class="sd">        &#39;&#39;&#39;</span>        
        <span class="k">if</span>  <span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeInstructionToEdit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">instructions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeToEdit</span><span class="p">]</span><span class="o">.</span><span class="n">getInstructions</span><span class="p">()</span>
                <span class="n">instructions</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recipeInstructionToEdit</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipeInstruction</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Ohje tallennettu&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populateRecipesInstructionsTable</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">SetAttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="s2">&quot;Virheellinen syöte!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span></div>
            
            
<div class="viewcode-block" id="MainGUI.saveStorageEdit"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.saveStorageEdit">[docs]</a>    <span class="k">def</span> <span class="nf">saveStorageEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi tarkistaa varastossa olevan raaka-aineen perustietojen tekstikenttien arvot, jonka jälkeen muutokset tallennetaan raaka-aineeseen.</span>
<span class="sd">        </span>
<span class="sd">        Oikea raaka-aine löydetään self.storageToEdit muuttujan avulla.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageQuantity</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageUnit</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageToEdit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">storage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">storageToEdit</span><span class="p">]</span>
                <span class="n">storage</span><span class="o">.</span><span class="n">setQuantity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storageQuantity</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">storage</span><span class="o">.</span><span class="n">setUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storageUnit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Varastotuote tallennettu&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populateStorageTable</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">SetAttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="s2">&quot;Virheellinen syöte!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="MainGUI.saveIngredientsEdit"><a class="viewcode-back" href="../Ohjelman_rakenne.html#mainGUI.MainGUI.saveIngredientsEdit">[docs]</a>    <span class="k">def</span> <span class="nf">saveIngredientsEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi tarkistaa raaka-aineen perustietojen tekstikenttien arvot, jonka jälkeen muutokset tallennetaan raaka-aineeseen.</span>
<span class="sd">        </span>
<span class="sd">        Oikea raaka-aine löydetään self.ingredientToEdit muuttujan avulla.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientName</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientDensity</span><span class="o">.</span><span class="n">hasAcceptableInput</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientToEdit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ingredient</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientToEdit</span><span class="p">]</span>
                <span class="n">ingredient</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientName</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">ingredient</span><span class="o">.</span><span class="n">setDensity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientDensity</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientAllergens</span><span class="o">.</span><span class="n">isModified</span><span class="p">():</span>
                    <span class="n">ingredient</span><span class="o">.</span><span class="n">removeAllergens</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientAllergens</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
                        <span class="n">ingredient</span><span class="o">.</span><span class="n">addAllergen</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientRecipe</span><span class="o">.</span><span class="n">isModified</span><span class="p">():</span>
                    <span class="n">recipe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientRecipe</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                    <span class="n">ingredient</span><span class="o">.</span><span class="n">removeRecipe</span><span class="p">()</span>
                    <span class="n">ingredient</span><span class="o">.</span><span class="n">setRecipe</span><span class="p">(</span><span class="n">recipe</span><span class="p">)</span>
                    <span class="n">ingredient</span><span class="o">.</span><span class="n">loadRecipe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Raaka-aine tallennettu&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">populateIngredientsTable</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">SetAttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe tallentaessa&quot;</span><span class="p">,</span> <span class="s2">&quot;Virheellinen syöte!&quot;</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span></div>
    
    
<div class="viewcode-block" id="MainGUI.openFileUTF8"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.openFileUTF8">[docs]</a>    <span class="k">def</span> <span class="nf">openFileUTF8</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">file</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi avaa halutun tiedoston UTF-8 enkoodauksella ja palauttaa sen tiedostokahvan.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            :file: tiedoston polku</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            :Onnistuessa: tiedostokahva avattuun tiedostoon</span>
<span class="sd">            :Epäonnistuessa: False</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fileIO</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">fileIO</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Tiedoston&quot;</span><span class="p">,</span><span class="nb">file</span><span class="p">,</span><span class="s2">&quot;avaaminen ei onnistu.&quot;</span><span class="p">)</span> 
            <span class="k">return</span> <span class="bp">False</span></div>
    
<div class="viewcode-block" id="MainGUI.loadFromFileToList"><a class="viewcode-back" href="../Ohjelman_rakenne.html#mainGUI.MainGUI.loadFromFileToList">[docs]</a>    <span class="k">def</span> <span class="nf">loadFromFileToList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi päättelee kutsujan (self.sender()) perusteella mikä tiedosto tulee ladata uudelleen ja myöskin lataa sen.</span>
<span class="sd">        </span>
<span class="sd">        Jos self.sender() on None, niin ladataan kaikki tiedostot. Muulloin kutsuja on esim. self.buttonLoadRecipes, jolloin ladataan</span>
<span class="sd">        reseptit tiedostosta.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">sender</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>        
            <span class="k">if</span> <span class="n">sender</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">sender</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttonLoadAll</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">fileIO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">openFileUTF8</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientsFile</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsSuccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsError</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">loadIngredients</span><span class="p">(</span><span class="n">fileIO</span><span class="p">)</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">fileIO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">openFileUTF8</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipesFile</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesSuccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesError</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">loadRecipes</span><span class="p">(</span><span class="n">fileIO</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">)</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">storageList</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">fileIO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">openFileUTF8</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storageFile</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">storageList</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageSuccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageError</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">loadStorage</span><span class="p">(</span><span class="n">fileIO</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Kaikki luettu sisään&quot;</span><span class="p">)</span>
                
                <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">loadRecipesForIngredients</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sender</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttonLoadRecipes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">fileIO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">openFileUTF8</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipesFile</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesSuccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesError</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">loadRecipes</span><span class="p">(</span><span class="n">fileIO</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Reseptit luettu sisään&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">sender</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttonLoadStorage</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">storageList</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">fileIO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">openFileUTF8</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storageFile</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">storageList</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageSuccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageError</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">loadStorage</span><span class="p">(</span><span class="n">fileIO</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Varastotilanne luettu sisään&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">sender</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttonLoadIngredients</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">fileIO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">openFileUTF8</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientsFile</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsSuccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsError</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">loadIngredients</span><span class="p">(</span><span class="n">fileIO</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Raaka-aineet luettu sisään&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">loadRecipesForIngredients</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Tuntematon tyyppi&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">except</span> <span class="n">CorruptedFileError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Virhe sisäänluvussa&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>    
        
        <span class="n">fileIO</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="MainGUI.saveToFile"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.saveToFile">[docs]</a>    <span class="k">def</span> <span class="nf">saveToFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Tämä metodi päättelee kutsujan (self.sender()) perusteella mikä tiedosto tulee tallentaa ja myöskin tallentaa sen.</span>
<span class="sd">        </span>
<span class="sd">        Jos self.sender() on self.buttonSaveAll, niin ladataan kaikki tiedostot. Muulloin kutsuja on esim. self.buttonSaveRecipes, jolloin </span>
<span class="sd">        tallennetaan reseptit tiedostoon.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">sender</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sender</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttonSaveAll</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">saveRecipes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipesFile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">saveIngredients</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientsFile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">saveStorage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storageFile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageList</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Kaikki tallennettu tiedostoihin&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">sender</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttonSaveRecipes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">saveRecipes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipesFile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">recipesList</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Reseptit tallennettu tiedostoihin&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">sender</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttonSaveIngredients</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">saveIngredients</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredientsFile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ingredientsList</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Raaka-aineet tallennettu tiedostoihin&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">sender</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttonSaveStorage</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">saveStorage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storageFile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageList</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="s2">&quot;Varastotilanne tallennettu tiedostoihin&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Kuka kutsuu SaveToFile?&quot;</span><span class="p">)</span></div>
    

<div class="viewcode-block" id="MainGUI.getIngredientsInDataListForTable"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.getIngredientsInDataListForTable">[docs]</a>    <span class="k">def</span> <span class="nf">getIngredientsInDataListForTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingredientList</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Muodostaa annetujen raaka-aineiden tiedoista listojen listan, jotka on helppo populoida QTabletWidget tauluun.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">allergens</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">recipes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">densities</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Nimi&#39;</span><span class="p">,</span> <span class="s1">&#39;Allergeenit&#39;</span><span class="p">,</span> <span class="s1">&#39;Resepti&#39;</span><span class="p">,</span> <span class="s1">&#39;Tiheys&#39;</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">ingredient</span> <span class="ow">in</span> <span class="n">ingredientList</span><span class="p">:</span>
            <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
            <span class="n">allergens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">getAllergensGUI</span><span class="p">())</span>
            <span class="n">recipes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">getRecipeGUI</span><span class="p">())</span>
            <span class="n">densities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingredient</span><span class="o">.</span><span class="n">getDensityGUI</span><span class="p">())</span>
        
        <span class="k">return</span> <span class="p">[</span><span class="n">headers</span><span class="p">,</span><span class="n">names</span><span class="p">,</span><span class="n">allergens</span><span class="p">,</span><span class="n">recipes</span><span class="p">,</span><span class="n">densities</span><span class="p">]</span></div>
    
<div class="viewcode-block" id="MainGUI.getIngredientContainersInDataListForTable"><a class="viewcode-back" href="../Koodi.html#mainGUI.MainGUI.getIngredientContainersInDataListForTable">[docs]</a>    <span class="k">def</span> <span class="nf">getIngredientContainersInDataListForTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ingredientContainerList</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Muodostaa annetujen raaka-aineiden(container) tiedoista listojen listan, jotka on helppo populoida QTabletWidget tauluun.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">quantities</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">units</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Nimi&#39;</span><span class="p">,</span> <span class="s1">&#39;Määrä&#39;</span><span class="p">,</span> <span class="s1">&#39;Yksikkö&#39;</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">ingredientContainer</span> <span class="ow">in</span> <span class="n">ingredientContainerList</span><span class="p">:</span>
            <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingredientContainer</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
            <span class="n">quantities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingredientContainer</span><span class="o">.</span><span class="n">getQuantityStr</span><span class="p">())</span>
            <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingredientContainer</span><span class="o">.</span><span class="n">getUnit</span><span class="p">())</span>
        
        <span class="k">return</span> <span class="p">[</span><span class="n">headers</span><span class="p">,</span><span class="n">names</span><span class="p">,</span><span class="n">quantities</span><span class="p">,</span><span class="n">units</span><span class="p">]</span></div>
    
<div class="viewcode-block" id="MainGUI.getRecipesInDataListForTable"><a class="viewcode-back" href="../Ohjelman_rakenne.html#mainGUI.MainGUI.getRecipesInDataListForTable">[docs]</a>    <span class="k">def</span> <span class="nf">getRecipesInDataListForTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recipeList</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Muodostaa annetujen reseptien tiedoista listojen listan, jotka on helppo populoida QTabletWidget tauluun.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">times</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">outcomes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">allergens</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Nimi&#39;</span><span class="p">,</span> <span class="s1">&#39;Aika&#39;</span><span class="p">,</span> <span class="s1">&#39;Lopputulos&#39;</span><span class="p">,</span> <span class="s1">&#39;Allergeenit&#39;</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">recipe</span> <span class="ow">in</span> <span class="n">recipeList</span><span class="p">:</span>
            <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recipe</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
            <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recipe</span><span class="o">.</span><span class="n">getTimeStr</span><span class="p">())</span>
            <span class="n">outcomes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recipe</span><span class="o">.</span><span class="n">getOutcomeStr</span><span class="p">())</span>
            <span class="n">allergens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recipe</span><span class="o">.</span><span class="n">getAllergensDistinctGUI</span><span class="p">())</span>
        
        <span class="k">return</span> <span class="p">[</span><span class="n">headers</span><span class="p">,</span><span class="n">names</span><span class="p">,</span><span class="n">times</span><span class="p">,</span><span class="n">outcomes</span><span class="p">,</span> <span class="n">allergens</span><span class="p">]</span></div></div>
    
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    
    <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">program</span> <span class="o">=</span> <span class="n">MainGUI</span><span class="p">()</span>
    <span class="n">program</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>  
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Pikahaku</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Siirry" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Kimi Päivärinta.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
    </div>

    

    
  </body>
</html>